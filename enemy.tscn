[gd_scene load_steps=32 format=3 uid="uid://d1k55f81hhw1c"]

[ext_resource type="Script" path="res://EnemyCharacterBody.gd" id="2_jmlmm"]
[ext_resource type="Texture2D" uid="uid://dfrbq758ji7i" path="res://sprites/Characters/EnemySmall2.png" id="3_w6leo"]
[ext_resource type="Script" path="res://Attack.gd" id="4_g7d4g"]
[ext_resource type="Texture2D" uid="uid://chujxb4e6pk0g" path="res://sprites/Animations/AttackAnim1.png" id="5_14m1h"]
[ext_resource type="Texture2D" uid="uid://bp11a7a475jro" path="res://sprites/Animations/AttackAnim2.png" id="6_flk04"]
[ext_resource type="Texture2D" uid="uid://b4labx8lkuv6l" path="res://sprites/Animations/AttackAnim3 2.png" id="7_hv8q8"]
[ext_resource type="Texture2D" uid="uid://b5o78h5iial6g" path="res://sprites/Animations/AttackAnim4.png" id="8_pyws7"]
[ext_resource type="Texture2D" uid="uid://4qspmbnqkk0g" path="res://sprites/Animations/AttackAnim5.png" id="9_f08ix"]
[ext_resource type="Texture2D" uid="uid://dyyawlyfqicph" path="res://sprites/Animations/AttackAnim6.png" id="10_qiyec"]
[ext_resource type="Texture2D" uid="uid://db5ftdh1diapq" path="res://sprites/Animations/AttackSpikeAnim-1.png" id="11_u8loq"]
[ext_resource type="Texture2D" uid="uid://fx34knry35ji" path="res://sprites/Animations/AttackSpikeAnim-2.png" id="12_kumkp"]
[ext_resource type="Texture2D" uid="uid://t46ucktc8r24" path="res://sprites/Animations/AttackSpikeAnim-3.png" id="13_xajot"]
[ext_resource type="Texture2D" uid="uid://conqyupcapmvr" path="res://sprites/Animations/AttackSpikeAnim-4.png" id="14_iwuwo"]
[ext_resource type="Texture2D" uid="uid://ckoyppydf0d61" path="res://sprites/Animations/AttackSpikeAnim-5.png" id="15_wpbh5"]
[ext_resource type="Texture2D" uid="uid://cbn5uafmb02c3" path="res://sprites/Animations/AttackSpikeAnim-6.png" id="16_rkfov"]
[ext_resource type="Texture2D" uid="uid://ccfpgn7wjm4r8" path="res://sprites/Animations/AttackSpikeAnim-7.png" id="17_xxik1"]
[ext_resource type="Texture2D" uid="uid://cpfcasbveh2f3" path="res://sprites/Animations/AttackSpikeAnim-8.png" id="18_3st66"]
[ext_resource type="Texture2D" uid="uid://bxslj0kd4kixd" path="res://sprites/Animations/AttackSpikeAnim-9.png" id="19_mugju"]
[ext_resource type="Texture2D" uid="uid://onps1uun7k2m" path="res://sprites/Animations/AttackSpikeAnim-10.png" id="20_78rhj"]
[ext_resource type="Texture2D" uid="uid://b5bq35yt13ayy" path="res://sprites/Animations/AttackSpikeAnim-11.png" id="21_b3twh"]
[ext_resource type="Texture2D" uid="uid://cxe2gxrraghxn" path="res://sprites/Animations/OnBeatPingAnim1.png" id="21_s8r10"]
[ext_resource type="PackedScene" uid="uid://c0cfkpl4s5pvp" path="res://health_pool.tscn" id="21_taojo"]
[ext_resource type="Texture2D" uid="uid://yowqn22xipkv" path="res://sprites/Animations/OnBeatPingAnim2.png" id="22_i1frw"]
[ext_resource type="Texture2D" uid="uid://bcvefb6k2im2r" path="res://sprites/Animations/OnBeatPingAnim3.png" id="23_0j2fv"]
[ext_resource type="Texture2D" uid="uid://dxpolj2bhdjl3" path="res://sprites/Animations/OnBeatPingAnim4.png" id="24_dsl5f"]
[ext_resource type="Texture2D" uid="uid://dibusnnrtsag7" path="res://sprites/Animations/OnBeatPingAnim5.png" id="25_q2dsx"]
[ext_resource type="Texture2D" uid="uid://brtassgl2hj48" path="res://sprites/Animations/OnBeatPingAnim6.png" id="26_ivk2p"]
[ext_resource type="Texture2D" uid="uid://cxe2gxrraghxn" path="res://sprites/Animations/OnBeatPingAnim1.png" id="21_s8r10"]
[ext_resource type="PackedScene" uid="uid://5qh7cbtr6d8a" path="res://health_pool.tscn" id="21_taojo"]
[ext_resource type="Texture2D" uid="uid://yowqn22xipkv" path="res://sprites/Animations/OnBeatPingAnim2.png" id="22_i1frw"]
[ext_resource type="Texture2D" uid="uid://bcvefb6k2im2r" path="res://sprites/Animations/OnBeatPingAnim3.png" id="23_0j2fv"]
[ext_resource type="Texture2D" uid="uid://dxpolj2bhdjl3" path="res://sprites/Animations/OnBeatPingAnim4.png" id="24_dsl5f"]
[ext_resource type="Texture2D" uid="uid://dibusnnrtsag7" path="res://sprites/Animations/OnBeatPingAnim5.png" id="25_q2dsx"]
[ext_resource type="Texture2D" uid="uid://brtassgl2hj48" path="res://sprites/Animations/OnBeatPingAnim6.png" id="26_ivk2p"]

[sub_resource type="SpriteFrames" id="SpriteFrames_j4upl"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_14m1h")
}, {
"duration": 1.0,
"texture": ExtResource("6_flk04")
}, {
"duration": 1.0,
"texture": ExtResource("7_hv8q8")
}, {
"duration": 1.0,
"texture": ExtResource("8_pyws7")
}, {
"duration": 1.0,
"texture": ExtResource("9_f08ix")
}, {
"duration": 1.0,
"texture": ExtResource("10_qiyec")
}],
"loop": true,
"name": &"AttackAnimation",
"speed": 12.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("11_u8loq")
}, {
"duration": 1.0,
"texture": ExtResource("12_kumkp")
}, {
"duration": 1.0,
"texture": ExtResource("13_xajot")
}, {
"duration": 1.0,
"texture": ExtResource("14_iwuwo")
}, {
"duration": 1.0,
"texture": ExtResource("15_wpbh5")
}, {
"duration": 1.0,
"texture": ExtResource("16_rkfov")
}, {
"duration": 1.0,
"texture": ExtResource("17_xxik1")
}, {
"duration": 1.0,
"texture": ExtResource("18_3st66")
}, {
"duration": 1.0,
"texture": ExtResource("19_mugju")
}, {
"duration": 1.0,
"texture": ExtResource("20_78rhj")
}, {
"duration": 1.0,
"texture": ExtResource("21_b3twh")
}],
"loop": true,
"name": &"AttackSpike",
"speed": 18.0
}]

[sub_resource type="GDScript" id="GDScript_k82y8"]
resource_name = "Enemy"
script/source = "extends TimedNode2D

# Called when the node enters the scene tree for the first time.
func _ready():
	super._ready()
	set_actions([
		func():
			if get_parent().target:
				$\"../Attack\".start(get_parent().target.global_position),
		func(): get_parent().step(50),
		func(): get_parent().step(50),
		func(): get_parent().step(150),
	])
"

[sub_resource type="SpriteFrames" id="SpriteFrames_xh55y"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("21_s8r10")
}, {
"duration": 1.0,
"texture": ExtResource("22_i1frw")
}, {
"duration": 1.0,
"texture": ExtResource("23_0j2fv")
}, {
"duration": 1.0,
"texture": ExtResource("24_dsl5f")
}, {
"duration": 1.0,
"texture": ExtResource("25_q2dsx")
}, {
"duration": 1.0,
"texture": ExtResource("26_ivk2p")
}],
"loop": true,
"name": &"default",
"speed": 18.0
}]

[sub_resource type="GDScript" id="GDScript_jw3hv"]
script/source = "extends AnimatedSprite2D

func _on_animation_looped():
	stop()

func _on_health_pool_health_changed():
	play()
"

[node name="Enemy" type="CharacterBody2D"]
script = ExtResource("2_jmlmm")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="."]
visible = false
polygon = PackedVector2Array(1, -48, 16, -23, 17, 4, -4, 42, -10, 32, -13, -25, -10, -39)

[node name="StepTimer" type="Timer" parent="."]
one_shot = true

[node name="Sprite2D" type="Sprite2D" parent="."]
texture = ExtResource("3_w6leo")

[node name="Attack" type="CharacterBody2D" parent="."]
position = Vector2(0, -21)
script = ExtResource("4_g7d4g")

[node name="Animation" type="AnimatedSprite2D" parent="Attack"]
rotation = 3.14159
scale = Vector2(1.3, 1.3)
sprite_frames = SubResource("SpriteFrames_j4upl")
animation = &"AttackSpike"
offset = Vector2(-40, 2)
flip_h = true

[node name="Area2D" type="Area2D" parent="Attack"]
rotation = 1.5708

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Attack/Area2D"]
position = Vector2(88, -7.27596e-12)
polygon = PackedVector2Array(-98.0005, -131, -79.0005, -131, -79, 5.99997, -98, 6.00004)

[node name="TimedNode2D" type="Node2D" parent="."]
position = Vector2(838, 256)
script = SubResource("GDScript_k82y8")

[node name="HealthPool" parent="." instance=ExtResource("21_taojo")]
position = Vector2(0, -62)
health = 2.0
max_health = 2.0

[node name="HurtAnimation" type="AnimatedSprite2D" parent="."]
position = Vector2(0, -12)
sprite_frames = SubResource("SpriteFrames_xh55y")
script = SubResource("GDScript_jw3hv")

[connection signal="timeout" from="StepTimer" to="." method="_on_step_timer_timeout"]
[connection signal="attack_hit" from="Attack" to="." method="_on_attack_attack_hit"]
[connection signal="animation_looped" from="Attack/Animation" to="Attack" method="_on_animation_animation_looped"]
[connection signal="die" from="HealthPool" to="." method="_on_health_pool_die"]
[connection signal="health_changed" from="HealthPool" to="HurtAnimation" method="_on_health_pool_health_changed"]
[connection signal="animation_looped" from="HurtAnimation" to="HurtAnimation" method="_on_animation_looped"]
